#!/usr/bin/env python3
"""
Activity 1: LED Sequence Control
For Raspberry Pi 5 using Thonny IDE
Using GPIO Zero library for Pi 5 compatibility
"""

from gpiozero import Button, LED
from signal import pause
import time

# ========== CONFIGURATION ==========
# GPIO Pin Definitions
BUTTON_PIN = 14      # GPIO14 for push button
GREEN_LED_PIN = 15   # GPIO15 for Green LED
YELLOW_LED_PIN = 16  # GPIO16 for Yellow LED
RED_LED_PIN = 17     # GPIO17 for Red LED

# Timing Constants (in seconds)
YELLOW_DURATION = 3   # Yellow LED stays ON for 3 seconds
RED_DURATION = 10     # Red LED stays ON for 10 seconds

# State variables
sequence_active = False  # Tracks if sequence is running

# ========== INITIALIZE COMPONENTS ==========
button = Button(BUTTON_PIN, pull_up=True, bounce_time=0.3)
green_led = LED(GREEN_LED_PIN)
yellow_led = LED(YELLOW_LED_PIN)
red_led = LED(RED_LED_PIN)

# ========== LED CONTROL FUNCTIONS ==========
def turn_on_green():
    """Turn ON only Green LED"""
    green_led.on()
    yellow_led.off()
    red_led.off()
    print("✓ Green LED ON")

def turn_on_yellow():
    """Turn ON only Yellow LED"""
    green_led.off()
    yellow_led.on()
    red_led.off()
    print("✓ Yellow LED ON")

def turn_on_red():
    """Turn ON only Red LED"""
    green_led.off()
    yellow_led.off()
    red_led.on()
    print("✓ Red LED ON")

# ========== SEQUENCE FUNCTION ==========
def run_led_sequence():
    """
    Execute the complete LED sequence:
    1. Yellow LED for 3 seconds
    2. Red LED for 10 seconds
    3. Return to Green LED
    """
    global sequence_active
    
    if sequence_active:
        return  # Don't start if already running
    
    sequence_active = True
    print("\n" + "="*50)
    print("STARTING LED SEQUENCE")
    print("="*50)
    
    # Step 1: Yellow LED (3 seconds)
    turn_on_yellow()
    print(f"Yellow LED will stay ON for {YELLOW_DURATION} seconds...")
    
    # Countdown for Yellow LED
    for i in range(YELLOW_DURATION, 0, -1):
        print(f"  Yellow: {i} second(s) remaining")
        time.sleep(1)
    
    # Step 2: Red LED (10 seconds)
    turn_on_red()
    print(f"\nRed LED will stay ON for {RED_DURATION} seconds...")
    
    # Countdown for Red LED
    for i in range(RED_DURATION, 0, -1):
        print(f"  Red: {i} second(s) remaining")
        time.sleep(1)
    
    # Step 3: Return to Green LED
    turn_on_green()
    print("\n✓ Sequence complete!")
    print("System ready for next button press")
    print("="*50 + "\n")
    
    sequence_active = False

# ========== BUTTON EVENT HANDLER ==========
def button_pressed():
    """Called when button is pressed"""
    run_led_sequence()

# ========== MAIN PROGRAM ==========
def main():
    """
    Main program
    """
    print("="*50)
    print("ACTIVITY 1: LED SEQUENCE CONTROLLER")
    print("Raspberry Pi 5 with GPIO Zero")
    print("="*50)
    
    # Set initial state
    turn_on_green()
    print("Initial state: Green LED ON")
    print("Press the button to start the sequence...")
    
    # Setup button event
    button.when_pressed = button_pressed
    
    try:
        # Keep program running
        pause()
        
    except KeyboardInterrupt:
        # Handle Ctrl+C gracefully
        print("\n" + "="*50)
        print("Program interrupted by user")
        print("="*50)

# ========== PROGRAM ENTRY POINT ==========
if __name__ == "__main__":
    main()
